<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Common</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Common.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption" class="empty">&nbsp;</p></div><div id="content"><div id="module-header"><p class="caption">Common</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Common types
</a></li><li><a href="#g:2">Dates and times
</a></li><li><a href="#g:3">Extra combinators
</a></li><li><a href="#g:4">Simple contract templates
</a></li><li><a href="#g:5">More complex trades
</a></li><li><a href="#g:6">Trade metadata
</a></li><li><a href="#g:7">Types for margining, fixing, netting, settlement
</a></li><li><a href="#g:8">Fee calculations
</a></li><li><a href="#g:9">Utilities
</a></li><li><a href="#g:10">List helper functions
</a></li><li><a href="#g:11">Basic math functions
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Copyright 2011 Netrium Ltd. All rights reserved.
</p><p>Module for common types and functions
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">type</span> <a href="#t:Price">Price</a> = <a href="Observable.html#t:Obs">Obs</a> Double</li><li class="src short"><span class="keyword">type</span> <a href="#t:Volume">Volume</a> = <a href="Observable.html#t:Obs">Obs</a> Double</li><li class="src short"><span class="keyword">type</span> <a href="#t:PriceCurve">PriceCurve</a> = [<a href="Common.html#t:Price">Price</a>]</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Market">Market</a>  = <a href="#v:Market">Market</a> <a href="Contract.html#t:Commodity">Commodity</a> <a href="Contract.html#t:Unit">Unit</a> <a href="Contract.html#t:Location">Location</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Product">Product</a>  = <a href="#v:Product">Product</a> <a href="Common.html#t:Market">Market</a> <a href="Common.html#t:Schedule">Schedule</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Index">Index</a> = <a href="Observable.html#t:Obs">Obs</a> Double</li><li class="src short"><span class="keyword">type</span> <a href="#t:Schedule">Schedule</a> = [<a href="Common.html#t:DateTime">DateTime</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:SegmentedSchedule">SegmentedSchedule</a> = [[<a href="Common.html#t:DateTime">DateTime</a>]]</li><li class="src short"><span class="keyword">type</span> <a href="#t:AmortisationTable">AmortisationTable</a> = [(Double, Double)]</li><li class="src short"><span class="keyword">type</span> <a href="#t:DayCountConvention">DayCountConvention</a> = Double</li><li class="src short"><span class="keyword">type</span> <a href="#t:Underlying">Underlying</a> = <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:DateTime">DateTime</a> = UTCTime</li><li class="src short"><a href="#v:toGregorian-39-">toGregorian'</a> :: <a href="Common.html#t:DateTime">DateTime</a> -&gt; (Integer, Int, Int)</li><li class="src short"><a href="#v:date">date</a> :: Integer -&gt; Int -&gt; Int -&gt; <a href="Common.html#t:DateTime">DateTime</a></li><li class="src short"><a href="#v:datetime">datetime</a> :: Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; <a href="Common.html#t:DateTime">DateTime</a></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:DiffDateTime">DiffDateTime</a>  = <a href="#v:DiffDateTime">DiffDateTime</a> (<a href="Common.html#t:DateTime">DateTime</a> -&gt; <a href="Common.html#t:DateTime">DateTime</a>)</li><li class="src short"><a href="#v:-60--62-">(&lt;&gt;)</a> :: Monoid a =&gt; a -&gt; a -&gt; a</li><li class="src short"><a href="#v:adjustDateTime">adjustDateTime</a> :: <a href="Common.html#t:DateTime">DateTime</a> -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a> -&gt; <a href="Common.html#t:DateTime">DateTime</a></li><li class="src short"><a href="#v:daysLater">daysLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:daysEarlier">daysEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:monthsEarlier">monthsEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:monthsLater">monthsLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:quartersLater">quartersLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:quartersEarlier">quartersEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:yearsEarlier">yearsEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:yearsLater">yearsLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:seasons">seasons</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:atTimeOfDay">atTimeOfDay</a> :: Int -&gt; Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:onDayOfMonth">onDayOfMonth</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:inMonth">inMonth</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></li><li class="src short"><a href="#v:duration">duration</a> :: Int -&gt; Int -&gt; Int -&gt; <a href="Contract.html#t:Duration">Duration</a></li><li class="src short"><a href="#v:convertDouble">convertDouble</a> :: <a href="Observable.html#t:Obs">Obs</a> Double -&gt; <a href="Observable.html#t:Obs">Obs</a> Double -&gt; <a href="Observable.html#t:Obs">Obs</a> Double</li><li class="src short"><a href="#v:allOf">allOf</a> :: [<a href="Contract.html#t:Contract">Contract</a>] -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:orZero">orZero</a> :: <a href="Contract.html#t:ChoiceId">ChoiceId</a> -&gt; <a href="Contract.html#t:Contract">Contract</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:physical">physical</a> :: <a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Market">Market</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:physicalWithDuration">physicalWithDuration</a> :: <a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Market">Market</a> -&gt; <a href="Contract.html#t:Duration">Duration</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:financial">financial</a> :: <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:fixedPrice">fixedPrice</a> :: Double -&gt; <a href="Common.html#t:Price">Price</a></li><li class="src short"><a href="#v:floatingPrice">floatingPrice</a> :: <a href="Observable.html#t:Obs">Obs</a> Double -&gt; <a href="Common.html#t:Price">Price</a></li><li class="src short"><a href="#v:scheduledContract">scheduledContract</a> :: <a href="Contract.html#t:Contract">Contract</a> -&gt; <a href="Common.html#t:Schedule">Schedule</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:zcb">zcb</a> :: <a href="Common.html#t:DateTime">DateTime</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:chooserLeg">chooserLeg</a> :: Int -&gt; Int -&gt; <a href="Observable.html#t:Time">Time</a> -&gt; <a href="Common.html#t:Schedule">Schedule</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; <a href="Common.html#t:Index">Index</a> -&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:chooserNote">chooserNote</a> :: [<a href="Contract.html#t:Contract">Contract</a>] -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:forward">forward</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:Market">Market</a> -&gt; <a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Common.html#t:Schedule">Schedule</a> -&gt; <a href="Common.html#t:Schedule">Schedule</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:commoditySwing">commoditySwing</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:Market">Market</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; (<a href="Common.html#t:Volume">Volume</a>, <a href="Common.html#t:Volume">Volume</a>, <a href="Common.html#t:Volume">Volume</a>) -&gt; Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a> -&gt; <a href="Common.html#t:SegmentedSchedule">SegmentedSchedule</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:CounterParty">CounterParty</a>  = <a href="#v:CounterParty">CounterParty</a> String</li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:Trader">Trader</a>  = <a href="#v:Trader">Trader</a> String</li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:Book">Book</a>  = <a href="#v:Book">Book</a> String</li><li class="src short"><span class="keyword">type</span> <a href="#t:MarginingSchedule">MarginingSchedule</a> = <a href="Common.html#t:Schedule">Schedule</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:FixingSchedule">FixingSchedule</a> = <a href="Common.html#t:Schedule">Schedule</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:SettlementSchedule">SettlementSchedule</a> = <a href="Common.html#t:Schedule">Schedule</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:SettlementVolumeVariance">SettlementVolumeVariance</a> = <a href="Observable.html#t:Obs">Obs</a> Double</li><li class="src short"><span class="keyword">data</span>  <a href="#t:SettlementAgreement">SettlementAgreement</a>  = <a href="#v:SettlementAgreement">SettlementAgreement</a> <a href="Common.html#t:Market">Market</a> <a href="Common.html#t:SettlementSchedule">SettlementSchedule</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:MarketNettingAgreement">MarketNettingAgreement</a>  = <a href="#v:MarketNettingAgreement">MarketNettingAgreement</a> <a href="Common.html#t:CounterParty">CounterParty</a> <a href="Common.html#t:Market">Market</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:CrossMarketNettingAgreement">CrossMarketNettingAgreement</a>  = <a href="#v:CrossMarketNettingAgreement">CrossMarketNettingAgreement</a> <a href="Common.html#t:CounterParty">CounterParty</a></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:FeeCalc">FeeCalc</a>  = <a href="#v:FeeCalc">FeeCalc</a> (<a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; Int -&gt; <a href="Contract.html#t:Contract">Contract</a>)</li><li class="src short"><a href="#v:calcFee">calcFee</a> ::  <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; [a] -&gt; <a href="Contract.html#t:Contract">Contract</a></li><li class="src short"><a href="#v:zeroFee">zeroFee</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a></li><li class="src short"><a href="#v:initialMarginFee">initialMarginFee</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a></li><li class="src short"><a href="#v:computedFee">computedFee</a> :: <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></li><li class="src short"><a href="#v:fixedFee">fixedFee</a> :: <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; Double -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></li><li class="src short"><a href="#v:exchangeFee">exchangeFee</a> :: <a href="Common.html#t:Price">Price</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></li><li class="src short"><a href="#v:andFee">andFee</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:TradedDate">TradedDate</a> = <a href="Observable.html#t:Obs">Obs</a> <a href="Common.html#t:DateTime">DateTime</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Direction">Direction</a> <ul class="subs"><li>= <a href="#v:DGive">DGive</a>  </li><li>| <a href="#v:DTake">DTake</a>  </li></ul></li><li class="src short"><a href="#v:getAmRate">getAmRate</a> :: <a href="Observable.html#t:Obs">Obs</a> Double -&gt; <a href="Common.html#t:AmortisationTable">AmortisationTable</a> -&gt; <a href="Observable.html#t:Obs">Obs</a> Double</li><li class="src short"><a href="#v:lastn">lastn</a> ::  Int -&gt; [a] -&gt; [a]</li><li class="src short"><a href="#v:square">square</a> :: Num n =&gt; n -&gt; n</li></ul></div><div id="interface"><h1 id="g:1">Common types
</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Price" class="def">Price</a> = <a href="Observable.html#t:Obs">Obs</a> Double</p><div class="doc"><p>A price is modelled as an observable double
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Volume" class="def">Volume</a> = <a href="Observable.html#t:Obs">Obs</a> Double</p><div class="doc"><p>A volume is modelled as an observable double
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:PriceCurve" class="def">PriceCurve</a> = [<a href="Common.html#t:Price">Price</a>]</p><div class="doc"><p>A price curve is a list of prices
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Market" class="def">Market</a>  </p><div class="doc"><p>Markets, e.g. UK Power (Electricity MWh UK), NBP Gas (Gas TH UK)
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Market" class="def">Market</a> <a href="Contract.html#t:Commodity">Commodity</a> <a href="Contract.html#t:Unit">Unit</a> <a href="Contract.html#t:Location">Location</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Product" class="def">Product</a>  </p><div class="doc"><p>A product is defined as a market and a delivery schedule
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Product" class="def">Product</a> <a href="Common.html#t:Market">Market</a> <a href="Common.html#t:Schedule">Schedule</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Index" class="def">Index</a> = <a href="Observable.html#t:Obs">Obs</a> Double</p><div class="doc"><p>Index, e.g. SPX
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Schedule" class="def">Schedule</a> = [<a href="Common.html#t:DateTime">DateTime</a>]</p><div class="doc"><p>Basic schedule, defined as a ist of date times
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SegmentedSchedule" class="def">SegmentedSchedule</a> = [[<a href="Common.html#t:DateTime">DateTime</a>]]</p><div class="doc"><p>Advanced schedule, defined as a list of time ranges
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:AmortisationTable" class="def">AmortisationTable</a> = [(Double, Double)]</p><div class="doc"><p>Amortisation table, defined as a list of amortisation rates and observation rates
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:DayCountConvention" class="def">DayCountConvention</a> = Double</p><div class="doc"><p>Day count conventions, e.g. 90/360
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:Underlying" class="def">Underlying</a> = <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>Underlying assets
</p></div></div><h1 id="g:2">Dates and times
</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:DateTime" class="def">DateTime</a> = UTCTime</p><div class="doc"><p>Use the UTC format
</p></div></div><div class="top"><p class="src"><a name="v:toGregorian-39-" class="def">toGregorian'</a> :: <a href="Common.html#t:DateTime">DateTime</a> -&gt; (Integer, Int, Int)</p><div class="doc"><p>Deconstruct a DateTime
</p></div></div><div class="top"><p class="src"><a name="v:date" class="def">date</a> :: Integer -&gt; Int -&gt; Int -&gt; <a href="Common.html#t:DateTime">DateTime</a></p><div class="doc"><p>Midnight on a given day
</p></div></div><div class="top"><p class="src"><a name="v:datetime" class="def">datetime</a> :: Integer -&gt; Int -&gt; Int -&gt; Int -&gt; Int -&gt; <a href="Common.html#t:DateTime">DateTime</a></p><div class="doc"><p>A point in time on a given day
</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:DiffDateTime" class="def">DiffDateTime</a>  </p><div class="doc"><p>The difference between 2 date times
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:DiffDateTime" class="def">DiffDateTime</a> (<a href="Common.html#t:DateTime">DateTime</a> -&gt; <a href="Common.html#t:DateTime">DateTime</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:DiffDateTime" class="caption collapser" onclick="toggleSection('i:DiffDateTime')">Instances</p><div id="section.i:DiffDateTime" class="show"><table><tr><td class="src">Monoid <a href="Common.html#t:DiffDateTime">DiffDateTime</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:-60--62-" class="def">(&lt;&gt;)</a> :: Monoid a =&gt; a -&gt; a -&gt; a</p><div class="doc"><p>Used to append hours and minutes to a date, i.e. define the time within a day
</p></div></div><div class="top"><p class="src"><a name="v:adjustDateTime" class="def">adjustDateTime</a> :: <a href="Common.html#t:DateTime">DateTime</a> -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a> -&gt; <a href="Common.html#t:DateTime">DateTime</a></p><div class="doc"><p>Adjust a date time by a given date time difference
</p></div></div><div class="top"><p class="src"><a name="v:daysLater" class="def">daysLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a positive time difference of a given number of days
</p></div></div><div class="top"><p class="src"><a name="v:daysEarlier" class="def">daysEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a negative time difference of a given number of days
</p></div></div><div class="top"><p class="src"><a name="v:monthsEarlier" class="def">monthsEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a positive time difference of a given number of months
</p></div></div><div class="top"><p class="src"><a name="v:monthsLater" class="def">monthsLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a negative time difference of a given number of months
</p></div></div><div class="top"><p class="src"><a name="v:quartersLater" class="def">quartersLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a negative time difference of a given number of quarters
</p></div></div><div class="top"><p class="src"><a name="v:quartersEarlier" class="def">quartersEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a positive time difference of a given number of quarters
</p></div></div><div class="top"><p class="src"><a name="v:yearsEarlier" class="def">yearsEarlier</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a positive time difference of a given number of years
</p></div></div><div class="top"><p class="src"><a name="v:yearsLater" class="def">yearsLater</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a negative time difference of a given number of years
</p></div></div><div class="top"><p class="src"><a name="v:seasons" class="def">seasons</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a time difference of a given number of seasons
</p><p>Not implemented yet
</p></div></div><div class="top"><p class="src"><a name="v:atTimeOfDay" class="def">atTimeOfDay</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>Hours
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Minutes
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Return the time difference between midnight and a given time
</p></div></div><div class="top"><p class="src"><a name="v:onDayOfMonth" class="def">onDayOfMonth</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a time difference of a given number of days
</p></div></div><div class="top"><p class="src"><a name="v:inMonth" class="def">inMonth</a> :: Int -&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></p><div class="doc"><p>Return a time difference of a given number of months
</p></div></div><div class="top"><p class="src"><a name="v:duration" class="def">duration</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>Hours
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Minutes
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Seconds
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Duration">Duration</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Define a time duration, in terms of hours, minutes and seconds.
</p></div></div><div class="top"><p class="src"><a name="v:convertDouble" class="def">convertDouble</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Observable.html#t:Obs">Obs</a> Double</td><td class="doc"><p>Double to convert
</p></td></tr><tr><td class="src">-&gt; <a href="Observable.html#t:Obs">Obs</a> Double</td><td class="doc"><p>Conversion factor
</p></td></tr><tr><td class="src">-&gt; <a href="Observable.html#t:Obs">Obs</a> Double</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Double conversion - e.g. FX, unit conversion
</p></div></div><h1 id="g:3">Extra combinators
</h1><div class="top"><p class="src"><a name="v:allOf" class="def">allOf</a> :: [<a href="Contract.html#t:Contract">Contract</a>] -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>Combine a list of contract into a contract
</p></div></div><div class="top"><p class="src"><a name="v:orZero" class="def">orZero</a> :: <a href="Contract.html#t:ChoiceId">ChoiceId</a> -&gt; <a href="Contract.html#t:Contract">Contract</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>Choice between a contract and a zero contract (used for options)
</p></div></div><h1 id="g:4">Simple contract templates
</h1><div class="top"><p class="src"><a name="v:physical" class="def">physical</a> :: <a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Market">Market</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>Basic physical leg
</p></div></div><div class="top"><p class="src"><a name="v:physicalWithDuration" class="def">physicalWithDuration</a> :: <a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Market">Market</a> -&gt; <a href="Contract.html#t:Duration">Duration</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>A physical leg with a duration
</p></div></div><div class="top"><p class="src"><a name="v:financial" class="def">financial</a> :: <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>Basic financial leg
</p></div></div><div class="top"><p class="src"><a name="v:fixedPrice" class="def">fixedPrice</a> :: Double -&gt; <a href="Common.html#t:Price">Price</a></p><div class="doc"><p>A fixed price: transform a double into an observable
</p></div></div><div class="top"><p class="src"><a name="v:floatingPrice" class="def">floatingPrice</a> :: <a href="Observable.html#t:Obs">Obs</a> Double -&gt; <a href="Common.html#t:Price">Price</a></p><div class="doc"><p>A floating price
</p></div></div><div class="top"><p class="src"><a name="v:scheduledContract" class="def">scheduledContract</a> :: <a href="Contract.html#t:Contract">Contract</a> -&gt; <a href="Common.html#t:Schedule">Schedule</a> -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>Distribute the contract over a schedule
</p><p>Used to apply a settlement/delivery schedule
</p></div></div><h1 id="g:5">More complex trades
</h1><div class="top"><p class="src"><a name="v:zcb" class="def">zcb</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Common.html#t:DateTime">DateTime</a></td><td class="doc"><p>Delivery date time
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Price">Price</a></td><td class="doc"><p>Notional amount
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Currency">Currency</a></td><td class="doc"><p>Payment currency
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a></td><td class="doc"><p>Cashflow type
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Contract">Contract</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A zero coupon bond: delivery of a notional amount at a given time
</p></div></div><div class="top"><p class="src"><a name="v:chooserLeg" class="def">chooserLeg</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>Range for observation period
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Index strike for observation period
</p></td></tr><tr><td class="src">-&gt; <a href="Observable.html#t:Time">Time</a></td><td class="doc"><p>Coupon settlement date
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Schedule">Schedule</a></td><td class="doc"><p>Dates for observation period
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Currency">Currency</a></td><td class="doc"><p>Payment currency
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Index">Index</a></td><td class="doc"><p>Coupon rate
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a></td><td class="doc"><p>Cashflow type
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Contract">Contract</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Chooser Range
</p><p>The note pays a coupon based on the number of days that e.g. 6-month LIBOR sits within an e.g. [80bps] range.
 The range is chosen by the buyer at the beginning of each coupon period.
</p></div></div><div class="top"><p class="src"><a name="v:chooserNote" class="def">chooserNote</a> :: [<a href="Contract.html#t:Contract">Contract</a>] -&gt; <a href="Contract.html#t:Contract">Contract</a></p><div class="doc"><p>A chooser note has a set of <code><a href="Common.html#v:chooserLeg">chooserLeg</a></code>
</p></div></div><div class="top"><p class="src"><a name="v:forward" class="def">forward</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Common.html#t:FeeCalc">FeeCalc</a></td><td class="doc"><p>Fees
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Market">Market</a></td><td class="doc"><p>Market, e.g. NBP Gas
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Volume">Volume</a></td><td class="doc"><p>Notional volume
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Price">Price</a></td><td class="doc"><p>Price
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Currency">Currency</a></td><td class="doc"><p>Payment currency
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a></td><td class="doc"><p>Cashflow type
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Schedule">Schedule</a></td><td class="doc"><p>Schedule for physical settlement
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Schedule">Schedule</a></td><td class="doc"><p>Schedule for financial settlement
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Contract">Contract</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Forward: agreement to buy or sell an asset at a pre-agreed future point
</p></div></div><div class="top"><p class="src"><a name="v:commoditySwing" class="def">commoditySwing</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Common.html#t:FeeCalc">FeeCalc</a></td><td class="doc"><p>Fees
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Market">Market</a></td><td class="doc"><p>Market, e.g. NBP Gas
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Price">Price</a></td><td class="doc"><p>Price
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Currency">Currency</a></td><td class="doc"><p>Payment currency
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:CashFlowType">CashFlowType</a></td><td class="doc"><p>Cashflow type
</p></td></tr><tr><td class="src">-&gt; (<a href="Common.html#t:Volume">Volume</a>, <a href="Common.html#t:Volume">Volume</a>, <a href="Common.html#t:Volume">Volume</a>)</td><td class="doc"><p>(low, normal, high) delivery volumes
</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>Number of exercise times
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:DiffDateTime">DiffDateTime</a></td><td class="doc"><p>How far the option is in advance
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:SegmentedSchedule">SegmentedSchedule</a></td><td class="doc"><p>Delivery schedule
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Contract">Contract</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Commodity swing: a contract guaranteeing one of two parties periodic delivery of a certain amount of commodity (the nominated amount)
 on certain dates in the future, within a given delivery period, at a stipulated constant price (the strike price).
</p><p>The party can also change (<a href="swing.html">swing</a>) the amount delivered from the nominated amount to a new amount on a short notice, for a limited number of times
</p></div></div><h1 id="g:6">Trade metadata
</h1><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:CounterParty" class="def">CounterParty</a>  </p><div class="doc"><p>Counterparty
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:CounterParty" class="def">CounterParty</a> String</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:CounterParty" class="caption collapser" onclick="toggleSection('i:CounterParty')">Instances</p><div id="section.i:CounterParty" class="show"><table><tr><td class="src">Eq <a href="Common.html#t:CounterParty">CounterParty</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Common.html#t:CounterParty">CounterParty</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:Trader" class="def">Trader</a>  </p><div class="doc"><p>Trader
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Trader" class="def">Trader</a> String</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Trader" class="caption collapser" onclick="toggleSection('i:Trader')">Instances</p><div id="section.i:Trader" class="show"><table><tr><td class="src">Eq <a href="Common.html#t:Trader">Trader</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Common.html#t:Trader">Trader</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:Book" class="def">Book</a>  </p><div class="doc"><p>Book
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Book" class="def">Book</a> String</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Book" class="caption collapser" onclick="toggleSection('i:Book')">Instances</p><div id="section.i:Book" class="show"><table><tr><td class="src">Eq <a href="Common.html#t:Book">Book</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">Show <a href="Common.html#t:Book">Book</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:7">Types for margining, fixing, netting, settlement
</h1><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:MarginingSchedule" class="def">MarginingSchedule</a> = <a href="Common.html#t:Schedule">Schedule</a></p><div class="doc"><p>Margining schedule
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:FixingSchedule" class="def">FixingSchedule</a> = <a href="Common.html#t:Schedule">Schedule</a></p><div class="doc"><p>Fixing schedule
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SettlementSchedule" class="def">SettlementSchedule</a> = <a href="Common.html#t:Schedule">Schedule</a></p><div class="doc"><p>Settlement schedule
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:SettlementVolumeVariance" class="def">SettlementVolumeVariance</a> = <a href="Observable.html#t:Obs">Obs</a> Double</p><div class="doc"><p>Settlement volume variance (for actuals)
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:SettlementAgreement" class="def">SettlementAgreement</a>  </p><div class="doc"><p>Settlement agreement
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:SettlementAgreement" class="def">SettlementAgreement</a> <a href="Common.html#t:Market">Market</a> <a href="Common.html#t:SettlementSchedule">SettlementSchedule</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:MarketNettingAgreement" class="def">MarketNettingAgreement</a>  </p><div class="doc"><p>Market netting agreement
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:MarketNettingAgreement" class="def">MarketNettingAgreement</a> <a href="Common.html#t:CounterParty">CounterParty</a> <a href="Common.html#t:Market">Market</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:CrossMarketNettingAgreement" class="def">CrossMarketNettingAgreement</a>  </p><div class="doc"><p>Cross-market netting agreement
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:CrossMarketNettingAgreement" class="def">CrossMarketNettingAgreement</a> <a href="Common.html#t:CounterParty">CounterParty</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><h1 id="g:8">Fee calculations
</h1><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:FeeCalc" class="def">FeeCalc</a>  </p><div class="doc"><p>Type for fee calculations
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:FeeCalc" class="def">FeeCalc</a> (<a href="Common.html#t:Volume">Volume</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Contract.html#t:Currency">Currency</a> -&gt; Int -&gt; <a href="Contract.html#t:Contract">Contract</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:FeeCalc" class="caption collapser" onclick="toggleSection('i:FeeCalc')">Instances</p><div id="section.i:FeeCalc" class="show"><table><tr><td class="src">Monoid <a href="Common.html#t:FeeCalc">FeeCalc</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:calcFee" class="def">calcFee</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Common.html#t:FeeCalc">FeeCalc</a></td><td class="doc"><p>Function to apply to calculate the fees
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Volume">Volume</a></td><td class="doc"><p>Contract notional volume
</p></td></tr><tr><td class="src">-&gt; <a href="Common.html#t:Price">Price</a></td><td class="doc"><p>Contract price
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Currency">Currency</a></td><td class="doc"><p>Contract currency
</p></td></tr><tr><td class="src">-&gt; [a]</td><td class="doc"><p>The schedule
</p></td></tr><tr><td class="src">-&gt; <a href="Contract.html#t:Contract">Contract</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Function to calculate fees
</p></div></div><div class="top"><p class="src"><a name="v:zeroFee" class="def">zeroFee</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a></p><div class="doc"><p>No fee
</p></div></div><div class="top"><p class="src"><a name="v:initialMarginFee" class="def">initialMarginFee</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a></p><div class="doc"><p>Fees for initial margin
</p></div></div><div class="top"><p class="src"><a name="v:computedFee" class="def">computedFee</a> :: <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; <a href="Common.html#t:Price">Price</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></p><div class="doc"><p>Basic calculated fees
</p></div></div><div class="top"><p class="src"><a name="v:fixedFee" class="def">fixedFee</a> :: <a href="Contract.html#t:CashFlowType">CashFlowType</a> -&gt; Double -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></p><div class="doc"><p>Fixed fees
</p></div></div><div class="top"><p class="src"><a name="v:exchangeFee" class="def">exchangeFee</a> :: <a href="Common.html#t:Price">Price</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></p><div class="doc"><p>Exchange fees
</p></div></div><div class="top"><p class="src"><a name="v:andFee" class="def">andFee</a> :: <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a> -&gt; <a href="Common.html#t:FeeCalc">FeeCalc</a></p><div class="doc"><p>Append 2 fee calculations
</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:TradedDate" class="def">TradedDate</a> = <a href="Observable.html#t:Obs">Obs</a> <a href="Common.html#t:DateTime">DateTime</a></p><div class="doc"><p>Traded date
</p></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Direction" class="def">Direction</a>  </p><div class="doc"><p>Contract direction (give or take)
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:DGive" class="def">DGive</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:DTake" class="def">DTake</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><h1 id="g:9">Utilities
</h1><div class="top"><p class="src"><a name="v:getAmRate" class="def">getAmRate</a> :: <a href="Observable.html#t:Obs">Obs</a> Double -&gt; <a href="Common.html#t:AmortisationTable">AmortisationTable</a> -&gt; <a href="Observable.html#t:Obs">Obs</a> Double</p><div class="doc"><p>Function to determine amortisation rate from an amortisation table and an observable rate
</p></div></div><h1 id="g:10">List helper functions
</h1><div class="top"><p class="src"><a name="v:lastn" class="def">lastn</a> ::  Int -&gt; [a] -&gt; [a]</p><div class="doc"><p>Extract n last elements from a list
</p></div></div><h1 id="g:11">Basic math functions
</h1><div class="top"><p class="src"><a name="v:square" class="def">square</a> :: Num n =&gt; n -&gt; n</p><div class="doc"><p>Square a double
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.9.2</p></div></body></html>